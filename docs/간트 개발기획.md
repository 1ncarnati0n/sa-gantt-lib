# 건설 표준공정표 기반 엔터프라이즈 간트차트 개발 기획서 (PRD)

## 1. 프로젝트 개요 (Project Overview)

본 프로젝트는 **실무가이드 2(단위공정 산출)**와 **실무가이드 3(공동주택 공사기간 산정)**의 개념을 통합한 **DOM+SVG 기반의 엔터프라이즈 간트차트**를 구축한다.

- **핵심 철학:** "단위공정(Guide 2)이 모여 주공정(CP)을 이루고, 이를 통해 전체 공사공정표(Guide 3)가 완성된다."
    
- **Phase 1 목표:** 사용자가 직관적으로 **작업일수(Vermilion)**와 **비작업일수(Teal)**를 구분하여 배치하고, **마일스톤**을 통해 전체 흐름을 잡는 UI/UX 구축.
    
- **Phase 2 목표:** 물량 기반 자동 산출 및 비작업일(기상, 휴무) 자동 보정 엔진 탑재.
    

## 2. 핵심 기술 요구사항 (Core Technical Requirements)

### 2.1 렌더링 아키텍처 (Rendering Architecture)

- **Hybrid Layout:**
    
    - **Left Panel (Grid):** HTML DOM 기반. WBS(Work Breakdown Structure) 계층 구조(그룹/단위공정) 표현 및 수치 입력.
        
    - **Right Panel (Timeline):** SVG 기반. 정교한 좌표 계산, 복합 바(Composite Bar), 마일스톤(Diamond Shape) 렌더링.
        
- **Virtualization:** 대용량 공정 데이터 처리를 위한 Windowing 기법 적용.
    

### 2.2 기술 스택 (Tech Stack)

- **Frontend:** React (TypeScript), Zustand (전역 상태 관리), date-fns.
    
- **Visualization:** D3.js (Scale & Axis) + Raw SVG.
    
- **Theme:** Tailwind CSS (Custom Colors: `bg-vermilion`, `bg-teal`).
    

## 3. 상세 기능 명세 (Detailed Features)

### 3.1 계층 구조 및 공정 관리 (Hierarchy & Management)

실무가이드 3의 거시적 관점과 가이드 2의 미시적 관점

- **Level 1: 마일스톤 & 요약 공정 (Master Schedule)**
    
    - 전체 프로젝트의 주요 이정표(착공, 지하골조 완료, 지상골조 완료, 준공 등).
        
    - 하위 단위공정들의 기간을 합산하여 요약(Summary) 바 형태로 표현.
        
- **Level 2: 단위 공정 (Unit Activity)**
    
    - 실무가이드 2 기반의 실제 작업 단위 (예: 토사굴착, 갱폼 설치).
        
    - **[작업일수]**와 **[비작업일수]**의 조합으로 구성됨.
        

### 3.2 캘린더 & 작업일수 로직 (Working vs Non-Working Logic)

기존의 순/간접 구분을 **'작업 가능 여부'** 관점에서 재정립한다.

- **Working Days (작업일수):**
    
    - **정의:** 인력과 장비가 실제 투입되어 생산성이 발생하는 기간 (순작업).
        
    - **캘린더:** 주말, 공휴일, 악천후 등 **휴무일 철저히 제외 (Skip Logic)**.
        
- **Non-Working Days (비작업일수):**
    
    - **정의:** 양생(Curing), 검측대기, 휴무일 보정, 정리기간 등 물리적 대기 시간 (간접작업).
        
    - **캘린더:** 기간의 연속성을 위해 **휴무일 포함 (Include Logic)**. (단, 설정에 따라 변경 가능)
        

### 3.3 시각화 : Vermilion & Teal (Visualization)

색상을 통해 작업의 성격을 명확히 구분한다.

- **Color Palette:**
    
    - **Vermilion (#E34234):** **[작업일수]** (Active, Critical). 강렬한 색상으로 실제 공사 수행 기간 강조.
        
    - **Teal (#008080):** **[비작업일수]** (Passive, Stable). 차분한 색상으로 양생, 대기, 여유 기간 표현.
        
- **Composite Bar:**
    
    - 하나의 Task Bar는 `Vermilion Rect`와 `Teal Rect`가 결합된 형태.
        
    - 배치 순서(Pre/Post)에 따라 Vermilion이 앞설 수도, Teal이 앞설 수도 있음.
        
- **Milestone Symbol:**
    
    - ◆ (Diamond Shape) 또는 ▼ (Inverted Triangle) 형태로 타임라인 상단에 표시.
        

### 3.4 의존성 및 주공정 (Dependencies & CPM)

- **Flexible Linking:**
    
    - 의존성 연결선은 **작업일수(Vermilion)**의 시작/끝을 기준으로 연결되는 것이 일반적임.
        
    - 예: A공정의 '작업(Vermilion)'이 끝나면 -> B공정의 '작업(Vermilion)' 시작. (중간에 비작업일이 끼어있어도 논리적 연결은 유효).
        
- **Critical Path (CP):**
    
    - 전체 공기(Duration)를 결정짓는 주공정 경로.
        
    - CP에 해당하는 Bar는 투명도(Opacity)를 낮추지 않고 강조하며, 연결선을 굵게 처리.
        

## 4. 데이터 구조 (Data Schema - TypeScript)

```
type CalendarRule = 'WORKING_DAY_ONLY' | 'INCLUDE_HOLIDAYS';
type Placement = 'PRE' | 'POST'; // 비작업일수가 작업일수의 앞(PRE)인지 뒤(POST)인지

interface ConstructionTask {
  id: string;
  parentId: string | null;
  type: 'MILESTONE' | 'SUMMARY' | 'TASK'; // 노드 타입 구분
  name: string;
  
  // 1. 기간 데이터 (Duration)
  workDays: number;     // 작업일수 (Vermilion) - 구 Net Duration
  nonWorkDays: number;  // 비작업일수 (Teal) - 구 Indirect Duration
  nonWorkPlacement: Placement; // 비작업일 배치 위치
  
  // 2. 캘린더 규칙
  workDayRule: CalendarRule;      
  nonWorkDayRule: CalendarRule; 
  
  // 3. 스케줄링 결과
  startDate: Date; 
  endDate: Date;   
  
  dependencies: Dependency[];
}

interface Milestone {
  id: string;
  date: Date;
  name: string;
  description?: string;
}
```

## 5. 단계별 개발 프롬프트 (For AI Assistant)

### Phase 1: Core Logic & Store

> "Zustand를 사용하여 `useConstructionStore`를 설계해줘. 핵심은 `Task`와 `Milestone`을 구분하는 거야. 날짜 계산 로직(`calculateDates`)에서 **`workDays`는 휴무일을 건너뛰고**, **`nonWorkDays`는 휴무일을 포함**하여 전체 기간을 산정하도록 해줘. 색상 테마 상수는 `Vermilion(#E34234)`과 `Teal(#008080)`으로 정의해."

### Phase 2: DOM Grid Implementation

> "좌측 Grid 패널을 만들어줘. WBS 구조(폴더 접기/펼치기)를 지원해야 해. 입력 필드는 `작업일수(Vermilion 라벨)`와 `비작업일수(Teal 라벨)`로 명확히 구분해서 디자인해줘."

### Phase 3: SVG Visualization (Updated)

> "우측 SVG 패널을 구현해줘.
> 
> 1. **Task Bar:** `<g>` 그룹 내에 `rect.vermilion`과 `rect.teal`을 배치 순서(`nonWorkPlacement`)에 맞춰 그려줘.
>     
> 2. **Milestone:** 타임라인 특정 날짜에 다이아몬드(◆) 심볼과 수직 가이드 라인을 그려줘.
>     
> 3. **Weekend/Holiday:** 배경에 회색 빗금 패턴을 깔아서 작업 불가일을 표시해줘."
>     

### Phase 4: Interaction

> "마일스톤을 드래그하여 날짜를 변경하면, 연결된 하위 공정들이 함께 이동하는지 확인하는 로직을 추가해줘. Task Bar 드래그 시 툴팁에는 '작업일수: 5일 / 비작업일수: 2일'과 같이 상세 정보가 나와야 해."